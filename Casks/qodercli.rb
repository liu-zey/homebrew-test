# This file was generated by GoReleaser. DO NOT EDIT.
cask "qodercli" do
  # 安装后创建源标记 - 用于更新检测
  postflight do
    # 标记文件应该放在最终的bin目录中，不是临时目录
    marker_path = "#{HOMEBREW_PREFIX}/bin/.qodercli-install-resource"
    File.write(marker_path, "homebrew-cask")

    # 测试最终安装的binary，不是临时目录中的
    system "#{HOMEBREW_PREFIX}/bin/qodercli", "--version"

    # 确保binary有执行权限
    File.chmod(0755, "#{HOMEBREW_PREFIX}/bin/qodercli")
  end

  name "qodercli"
  desc "Qoder AI CLI tool - Terminal-based AI assistant for code development"
  homepage "https://qoder.com"
  version "0.0.10-alpha.4"

  livecheck do
    skip "Auto-generated on release."
  end

  binary "qodercli"

  on_macos do
    on_intel do
      url "https://qs-cli-dev.oss-cn-hangzhou.aliyuncs.com/qodercli/releases/#{version}/qodercli_#{version}_darwin_amd64.zip"
      sha256 "98934363851cf101a7dbea348d40297fd441ea902b78000b3fd56e1772cff4be"
    end
    on_arm do
      url "https://qs-cli-dev.oss-cn-hangzhou.aliyuncs.com/qodercli/releases/#{version}/qodercli_#{version}_darwin_arm64.zip"
      sha256 "05b041bde138403809cb667e4e0ac70b20255687a1c4b4421a74302adeb09c9a"
    end
  end

  on_linux do
    on_intel do
      url "https://qs-cli-dev.oss-cn-hangzhou.aliyuncs.com/qodercli/releases/#{version}/qodercli_#{version}_linux_amd64.tar.gz"
      sha256 "2b0afa47951466f50017e10a7a7e943ff257252ba7ffbf04766544d1cd862e19"
    end
    on_arm do
      url "https://qs-cli-dev.oss-cn-hangzhou.aliyuncs.com/qodercli/releases/#{version}/qodercli_#{version}_linux_arm64.tar.gz"
      sha256 "8f6ecf0cf6c3d8ee1961797f0efc4b8f272be760011900dccd65486bb7c4bd78"
    end
  end

  # No zap stanza required
end
